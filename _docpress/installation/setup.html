
<div class="doc-layout">
  <div class="toggle menu-toggle js-menu-toggle"></div>
  <div class="menu toc-menu">
    <li class="menu-item -level-0 -parent">
      <ul class="submenu">
        <li class="menu-item -level-1"><a class="link title  link-index" href="/"></a>
        </li>
        <li class="menu-item -level-1"><a class="link title  link-search" href="/search">Search plugins &amp; themes</a>
        </li>
        <li class="menu-item -level-1 -parent"><a class="link title  link-installation" href="/installation/">Installation</a>
          <ul class="submenu">
            <li class="menu-item -level-2"><a class="link title  link-installationprerequisites" href="/installation/prerequisites">Prerequisites</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-installationcloning" href="/installation/cloning">Cloning</a>
            </li>
            <li class="menu-item -level-2"><a class="link title -active link-installationsetup" href="/installation/setup">Setup</a>
              <ul class="headings heading-list">
                <li class="heading-item -depth-2"><a class="hlink link-environment-variables" href="#environment-variables">Environment Variables</a></li>
                <li class="heading-item -depth-2"><a class="hlink link-google-cloud-sdk" href="#google-cloud-sdk">Google Cloud SDK</a></li>
                <li class="heading-item -depth-2"><a class="hlink link-api" href="#api">API</a></li>
                <li class="heading-item -depth-2"><a class="hlink link-mongodb" href="#mongodb">MongoDB</a></li>
                <li class="heading-item -depth-2"><a class="hlink link-install-go-dependencies" href="#install-go-dependencies">Install Go dependencies</a></li>
                <li class="heading-item -depth-2"><a class="hlink link-lighthouse-server" href="#lighthouse-server">Lighthouse Server</a></li>
                <li class="heading-item -depth-2"><a class="hlink link-phpcs-server" href="#phpcs-server">PHPCS Server</a></li>
                <li class="heading-item -depth-2"><a class="hlink link-sync-server" href="#sync-server">Sync Server</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li class="menu-item -level-1 -parent"><a class="link title  link-services" href="/services/">Services</a>
          <ul class="submenu">
            <li class="menu-item -level-2"><a class="link title  link-servicesapi" href="/services/api">API</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-servicessync" href="/services/sync">Sync Server</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-servicesphpcs" href="/services/phpcs">PHPCS Server</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-serviceslighthouse" href="/services/lighthouse">Lighthouse Server</a>
            </li>
          </ul>
        </li>
        <li class="menu-item -level-1 -parent"><a class="link title  link-gcp" href="/gcp/">Google Cloud Platform</a>
          <ul class="submenu">
            <li class="menu-item -level-2"><a class="link title  link-gcpsetup" href="/gcp/setup">Setup</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-gcpdeployments" href="/gcp/deployments">Deployments</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-gcpgcs" href="/gcp/gcs">Google Cloud Storage</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-gcpgcf" href="/gcp/gcf">Google Cloud Firestore</a>
            </li>
          </ul>
        </li>
        <li class="menu-item -level-1"><a class="link title  link-aws" href="/aws/">Amazon Web Services</a>
        </li>
      </ul>
    </li>
  </div>
  <div class="body page-installationsetup">
    <div class="header-nav">
      <div class="right"><a class="iconlink" href="https://github.com/wptide/docs" data-title="wptide/docs"><span class="icon -github"></span></a><a class="iconlink" href="https://make.wordpress.org/tide/" data-title="make.wordpress.org/tide"><svg version="1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><path d="M10 500a490 490 0 1 0 980 0 490 490 0 0 0-980 0zm38 0c0-66 14-128 39-184l216 591A452 452 0 0 1 48 500zm452 452c-44 0-87-6-128-18l136-394 139 380 3 7c-47 16-97 25-150 25zm366-460a427 427 0 0 0 31-209 450 450 0 0 1-170 608l139-399zm-98-140c17 30 37 69 37 125 0 39-11 87-34 146l-45 151-164-486c28-1 52-4 52-4 24-3 22-39-3-38 0 0-73 6-120 6-45 0-119-6-119-6-25-1-28 36-3 38l47 4 71 193-99 297-165-490c27-1 52-4 52-4 24-3 21-39-3-38 0 0-73 6-121 6h-29a452 452 0 0 1 683-85l-5-1c-45 0-76 39-76 80 0 38 21 69 44 106z"/></svg></a></div>
    </div>
    <div class="markdown-body"><h1 id="setup">Setup</h1>
<h2 id="environment-variables">Environment Variables</h2>
<p>Copy the <code>.env.dist</code> file to <code>.env</code>.</p>
<pre><code>$ cp .env.dist .env
</code></pre>
<p><code>.env</code> file is used to store custom values of environment variables for various services. Before setting up any of the services, update values according instructions for each service. The variables and their descriptions can be found at the end of each relevant section.</p>
<p>The <code>.tpl</code> files are template files that through variable interpolation are
converted and used to deploy your project to GCP and even setup the local API. So
these files play a critical role in getting Tide setup. If these files are not
generating the correct output, please <a href="#contact-us">contact us</a> to troubleshoot and
figure out a solution for your OS.</p>
<p>So far we&apos;ve only tested on OS X with and without the <code>envsubst</code> command available.
Other systems may not work correctly and we want to resolve that quickly.</p>
<h2 id="google-cloud-sdk">Google Cloud SDK</h2>
<p>Create a new Cloud Project using the <a href="https://console.cloud.google.com/">Cloud Console</a>.</p>
<p>Configure Google Cloud SDK with your account and the project ID you&apos;ve just created:</p>
<pre><code>$ gcloud init
</code></pre>
<p>Update the following environment variables in <code>.env</code> file:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Variable</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>GCP_PROJECT</code></td>
<td style="text-align:left">The unique ID of you Google project.</td>
</tr>
<tr>
<td style="text-align:left"><code>GCP_REGION</code></td>
<td style="text-align:left">The [region][regions-and-zones] where all your resources will be created. For example, <code>us-west1</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>GCP_ZONE</code></td>
<td style="text-align:left">The preferred [zone][regions-and-zones] in your region that resources will be created, For example, <code>us-west1-a</code>.</td>
</tr>
</tbody>
</table>
<h2 id="api">API</h2>
<p>Update the following environment variables in <code>.env</code> file:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Variable</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>API_ADMIN_EMAIL</code></td>
<td style="text-align:left">The email associated with the local admin account</td>
</tr>
<tr>
<td style="text-align:left"><code>API_ADMIN_PASSWORD</code></td>
<td style="text-align:left">The password associated with the local admin account</td>
</tr>
<tr>
<td style="text-align:left"><code>API_ADMIN_USER</code></td>
<td style="text-align:left">The username associated with the local admin account</td>
</tr>
<tr>
<td style="text-align:left"><code>API_KEY</code></td>
<td style="text-align:left">The API key used locally to authenticate the <code>audit-server</code> user.</td>
</tr>
<tr>
<td style="text-align:left"><code>API_SECRET</code></td>
<td style="text-align:left">The API secret used locally to authenticate the <code>audit-server</code> user.</td>
</tr>
</tbody>
</table>
<p>For local development you have to manually set the <code>API_KEY</code> and <code>API_SECRET</code> for the
<code>audit-server</code> user, which will automatically update the user meta values when
<code>make api.setup</code> is ran. If you are
running Tide in production, then you can access the auto generated key and secret
from the <code>audit-server</code> user profile.</p>
<p>Now install the dependencies as follows:</p>
<pre><code>$ make api.composer
</code></pre>
<p>Then start the API Docker images in isolation:</p>
<pre><code>$ make api.up
</code></pre>
<p>Last run the setup script:</p>
<pre><code>$ make api.setup
</code></pre>
<p>Run the setup script to initialize WordPress for the first time or if you would
like a convenient way to update the default values when you change relevant
environment variables.</p>
<p>If you see an error like this on OS X when bringing up the API you need to add the
directory to the <code>Preferences -&gt; File Sharing</code> section of the Docker for Mac app.</p>
<pre><code>ERROR: for gotide_api-mysql_1  Cannot start service api-mysql: b&apos;Mounts denied: ...&apos;
</code></pre>
<p>Add <code>127.0.0.1 tide.local</code> to your <code>hosts</code> file. You should be now able to run API at <a href="http://tide.local">tide.local</a></p>
<h2 id="mongodb">MongoDB</h2>
<p>By default MongoDB is used as the local message provider for the Lighthouse/PHPCS Servers. In order for these services to use MongoDB you&apos;ll need to ensure the following settings are in you <code>.env</code>. The only setting that you should <strong>not</strong> change is <code>MONGO_HOST</code>.</p>
<table>
<thead>
<tr>
<th style="text-align:left">Variable</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>MONGO_DATABASE_NAME</code></td>
<td style="text-align:left">The name of the database. Default is <code>queue</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>MONGO_DATABASE_PASSWORD</code></td>
<td style="text-align:left">The database root password. Default is <code>root</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>MONGO_DATABASE_USERNAME</code></td>
<td style="text-align:left">The database root username. Default is <code>root</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>MONGO_HOST</code></td>
<td style="text-align:left">The MongoDB database host and port. Default is <code>localhost:27017</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>MONGO_QUEUE_LH</code></td>
<td style="text-align:left">Specifies which collection in MongoDB to use for the Lighthouse message queue. Default is <code>lighthouse</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>MONGO_QUEUE_PHPCS</code></td>
<td style="text-align:left">Specifies which collection in MongoDB to use for the PHPCS message queue. Default is <code>phpcs</code>.</td>
</tr>
</tbody>
</table>
<h2 id="install-go-dependencies">Install Go dependencies</h2>
<p>Install Go dependencies to be able to build servers.</p>
<pre><code>$ glide install
</code></pre>
<h2 id="lighthouse-server">Lighthouse Server</h2>
<p>Build the Lighthouse Server Docker image and start the server</p>
<pre><code>$ make lighthouse.build.up
</code></pre>
<h2 id="phpcs-server">PHPCS Server</h2>
<p>Build the PHPCS Server Docker image and start the server:</p>
<pre><code>$ make phpcs.build.up
</code></pre>
<h2 id="sync-server">Sync Server</h2>
<p>Build the Sync Server Docker image and start the server:</p>
<pre><code>$ make sync.build.up
</code></pre>

    </div>
    <div class="footer-nav">
      <div class="left"><a href="../installation/cloning"><span class="title">Cloning</span></a></div>
      <div class="right"><a href="../services/"><span class="label">Next: </span><span class="title">Services</span></a></div>
    </div>
  </div>
</div>